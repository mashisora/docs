import{_ as s,c as a,o as n,a as l}from"./app.43496e99.js";const A=JSON.parse('{"title":"资产类型 Factory","description":"","frontmatter":{},"headers":[{"level":2,"title":"关于 Factory","slug":"关于-factory","link":"#关于-factory","children":[]},{"level":2,"title":"声明 Factory","slug":"声明-factory","link":"#声明-factory","children":[]},{"level":2,"title":"实现 FactoryCreateNew()","slug":"实现-factorycreatenew","link":"#实现-factorycreatenew","children":[]}],"relativePath":"asset/factory.md","lastUpdated":1660026515000}'),o={name:"asset/factory.md"},p=l(`<h1 id="资产类型-factory" tabindex="-1">资产类型 Factory <a class="header-anchor" href="#资产类型-factory" aria-hidden="true">#</a></h1><h2 id="关于-factory" tabindex="-1">关于 Factory <a class="header-anchor" href="#关于-factory" aria-hidden="true">#</a></h2><p>在 Unreal Editor 的内容浏览器中右键或点击工具栏的 Add 按钮，选择资产类型，Unreal Editor 会在当前目录创建一个该资产类型的实例。这一实例化过程是由 <code>UFactory</code> 的派生类完成的。</p><p><code>UFactory</code> 主要用于定义资产在 Unreal Editor 中的实例化方法和实例化后的行为。</p><p>本章节中，将用于构造特定资产类型的 <code>UFactory</code> 派生类称作 Factory 。</p><h2 id="声明-factory" tabindex="-1">声明 Factory <a class="header-anchor" href="#声明-factory" aria-hidden="true">#</a></h2><p>我们自定义的资产类型还没有相应的 Factory 为其实现 Unreal Editor 中的实例化方法，所以暂时不能被 Unreal Editor 识别为资产类型。我们需要为自定义资产类型声明一个 Factory 。</p><p>以下代码为自定义的资产类型声明一个 Factory ，该 Factory 至少需要指派以下 3 个属性，并重写 <code>FactoryCreateNew()</code> 方法：</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">UCLASS</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">UCustomAssetFactory</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">public</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">UFactory</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">GENERATED_BODY</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">UCustomAssetFactory</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    bCreateNew </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">true;</span></span>
<span class="line"><span style="color:#F07178;">    bEditAfterNew </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">true;</span></span>
<span class="line"><span style="color:#F07178;">    SupportedClass </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">UCustomAsset</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">StaticClass</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">virtual</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">UObject</span><span style="color:#C792EA;">*</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">FactoryCreateNew</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">UClass</span><span style="color:#C792EA;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">InClass</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">UObject</span><span style="color:#C792EA;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">InParent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">FName</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">InName</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">EObjectFlags</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">Flags</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">UObject</span><span style="color:#C792EA;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">Context</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">FFeedbackContext</span><span style="color:#C792EA;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">Warn</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">override</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><h2 id="实现-factorycreatenew" tabindex="-1">实现 FactoryCreateNew() <a class="header-anchor" href="#实现-factorycreatenew" aria-hidden="true">#</a></h2><p>实现该 Factory 的 <code>FactoryCreateNew()</code> 方法。该方法即为自定义资产类型在 Unreal Editor 中的实例化方法。</p><p>下面给出一种使用 <code>NewObject&lt;&gt;()</code> 实例化资产类型的最小实现：</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">UObject</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UCustomAssetFactory</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">FactoryCreateNew</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">UClass</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">InClass</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">UObject</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">InParent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FName</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">InName</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">EObjectFlags</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">Flags</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">UObject</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">Context</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FFeedbackContext</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">Warn</span></span>
<span class="line"><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">NewObject</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">UCustomAsset</span><span style="color:#89DDFF;">&gt;(</span><span style="color:#A6ACCD;">InParent</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InClass</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> InName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Flags</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div>`,13),e=[p];function t(c,r,y,F,C,i){return n(),a("div",null,e)}const d=s(o,[["render",t]]);export{A as __pageData,d as default};
