import{_ as s,c as n,o as a,a as l}from"./app.43496e99.js";const d=JSON.parse('{"title":"拓展菜单","description":"","frontmatter":{},"headers":[{"level":2,"title":"如何拓展菜单","slug":"如何拓展菜单","link":"#如何拓展菜单","children":[]},{"level":2,"title":"构造控件","slug":"构造控件","link":"#构造控件","children":[]},{"level":2,"title":"拓展主菜单栏","slug":"拓展主菜单栏","link":"#拓展主菜单栏","children":[{"level":3,"title":"拓展内置菜单","slug":"拓展内置菜单","link":"#拓展内置菜单","children":[]},{"level":3,"title":"添加菜单","slug":"添加菜单","link":"#添加菜单","children":[]}]},{"level":2,"title":"拓展工具栏","slug":"拓展工具栏","link":"#拓展工具栏","children":[{"level":3,"title":"添加按钮","slug":"添加按钮","link":"#添加按钮","children":[]},{"level":3,"title":"添加菜单按钮","slug":"添加菜单按钮","link":"#添加菜单按钮","children":[]}]},{"level":2,"title":"拓展右键菜单","slug":"拓展右键菜单","link":"#拓展右键菜单","children":[]},{"level":2,"title":"拓展其他菜单","slug":"拓展其他菜单","link":"#拓展其他菜单","children":[]}],"relativePath":"extend/menu.md","lastUpdated":1660026515000}'),o={name:"extend/menu.md"},p=l(`<h1 id="拓展菜单" tabindex="-1">拓展菜单 <a class="header-anchor" href="#拓展菜单" aria-hidden="true">#</a></h1><p>Unreal Editor 的菜单结构为：</p><p><code>UToolMenus -&gt; UToolMenu -&gt; FToolMenuSection -&gt; FToolMenuEntry</code></p><p>其中 <code>UToolMenus</code> 为一个单例全局对象，维护 Unreal Editor 中的所有全局菜单。可以通过此对象实现全局菜单的注册、拓展、获取等操作。</p><p>Unreal 还提供了 <code>FMenuBuilder</code> <code>FExtender</code> 等可用来拓展菜单的 API，相较之下，<code>UToolMenus</code> 有如下特点：</p><ul><li>可享受 <code>UObject</code> 带来的资源管理便利性</li><li>可借助 <code>.</code> 操作符，用形如 <code>LevelEditor.MainMenu</code> 的表达式定位任何一个全局菜单对象</li><li>对不同菜单控件提供了较为统一的 API 设计</li></ul><p>考虑到代码的简洁性、一致性和可维护性，本文优先使用 <code>UToolMenu</code> 相关 API 。</p><h2 id="如何拓展菜单" tabindex="-1">如何拓展菜单 <a class="header-anchor" href="#如何拓展菜单" aria-hidden="true">#</a></h2><p><code>UToolMenus</code> 是一个全局对象，Unreal Editor 的所有内置菜单均由其管理，我们在插件中使用 <code>UToolMenus</code> 注册自定义菜单时，需要确保 <code>UToolMenus</code> 及其相关系统已就绪。可以将拓展菜单的函数传入 <code>UToolMenus::RegisterStartupCallback()</code> ，来确保自定义菜单注册时 <code>UToolMenus</code> 系统已准备就绪</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Delays menu registration until safe and ready</span></span>
<span class="line"><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">RegisterStartupCallback</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FSimpleMulticastDelegate</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">FDelegate</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">CreateLambda</span><span style="color:#89DDFF;">([&amp;]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">FToolMenuOwnerScoped</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">OwnerScoped</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">this</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    // ...Register Custom Menus Here</span></span>
<span class="line"><span style="color:#89DDFF;">}));</span></span>
<span class="line"></span></code></pre></div><h2 id="构造控件" tabindex="-1">构造控件 <a class="header-anchor" href="#构造控件" aria-hidden="true">#</a></h2><p>在一些使用场景下，我们需要获取菜单对象对应的 <code>SWidget</code> ，例如：</p><ul><li>将菜单作为参数传入一些控件的构造函数</li><li>使用菜单作为控件进行 UI 设计</li></ul><p>本文提供两种方法实现获取一个菜单对应的 <code>SWidget</code></p><ol><li><p>如果菜单已经在 <code>UToolMenus</code> 中完成注册，那么可以使用 <code>UToolMenus</code> 提供的方法直接获取</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">TSharedRef</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">SWidget</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> MenuWidget </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">GenerateWidget</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Menu</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div></li><li><p>如菜单未注册到 <code>UToolMenus</code> ，也不想将其注册为全局菜单，可使用 <code>FMenuBuilder</code> 构建本地菜单，然后获取其 <code>SWidget</code> 对象供其他控件使用</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">FMenuBuilder</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MenuBuilder</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">true</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginCommands</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">MenuBuilder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddMenuEntry</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FMyCommands</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">().</span><span style="color:#A6ACCD;">PluginAction</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">TSharedRef</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">SWidget</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> MenuWidget </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MenuBuilder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">MakeWidget</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre></div></li></ol><h2 id="拓展主菜单栏" tabindex="-1">拓展主菜单栏 <a class="header-anchor" href="#拓展主菜单栏" aria-hidden="true">#</a></h2><h3 id="拓展内置菜单" tabindex="-1">拓展内置菜单 <a class="header-anchor" href="#拓展内置菜单" aria-hidden="true">#</a></h3><p>拓展 Unreal Editor 顶部菜单栏的内置菜单，以 Window 菜单为例</p><ul><li>拓展内置菜单 <code>LevelEditor.MainMenu.Window</code></li></ul><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">UToolMenu</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> Menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">ExtendMenu</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LevelEditor.MainMenu.Window</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuSection</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Section </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Menu</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">FindOrAddSection</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">WindowLayout</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuEntry</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Entry </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Section</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddEntry</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FToolMenuEntry</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">InitMenuEntry</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FMyCommands</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">().</span><span style="color:#A6ACCD;">PluginAction</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">Entry</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetCommandList</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">PluginCommands</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="添加菜单" tabindex="-1">添加菜单 <a class="header-anchor" href="#添加菜单" aria-hidden="true">#</a></h3><p>拓展 Unreal Editor 主界面顶部的主菜单栏，可以指定插入位置。</p><ul><li>拓展 <code>LevelEditor.MainMenu</code> 添加菜单栏按钮</li></ul><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">UToolMenu</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> Menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">ExtendMenu</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LevelEditor.MainMenu</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuSection</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Section </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Menu</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">FindOrAddSection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">NAME_None</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuEntry</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Entry </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Section</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddSubMenu</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">                                             // Name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">LOCTEXT</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">PluginName</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#676E95;font-style:italic;">                      // Display Name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">LOCTEXT</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">PluginDescription</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Plugin Description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span><span style="color:#676E95;font-style:italic;">   // Descriptions</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">FNewToolMenuChoice</span><span style="color:#89DDFF;">()</span><span style="color:#676E95;font-style:italic;">                                  // Contents: default</span></span>
<span class="line"><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">Entry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">InsertPosition </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">FToolMenuInsert</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Help</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">EToolMenuInsertType</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">Before</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><ul><li>拓展 <code>LevelEditor.MainMenu.Plugin</code> 创建自定义菜单</li></ul><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">UToolMenu</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> Menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">ExtendMenu</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LevelEditor.MainMenu.Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuSection</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Section </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Menu</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">FindOrAddSection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">NAME_None</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">Section</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddMenuEntryWithCommandList</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FMyCommands</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">().</span><span style="color:#A6ACCD;">PluginAction</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">     // Command</span></span>
<span class="line"><span style="color:#A6ACCD;">  PluginCommands</span><span style="color:#676E95;font-style:italic;">                       // CommandList</span></span>
<span class="line"><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="拓展工具栏" tabindex="-1">拓展工具栏 <a class="header-anchor" href="#拓展工具栏" aria-hidden="true">#</a></h2><p>拓展 Unreal Editor 主界面的工具栏。在 Unreal Editor 的工具栏中，使用 <code>ToolBarButton</code> 实现按钮，使用 <code>ComboButton</code> 实现带有菜单的按钮</p><h3 id="添加按钮" tabindex="-1">添加按钮 <a class="header-anchor" href="#添加按钮" aria-hidden="true">#</a></h3><ul><li>拓展 <code>LevelEditor.LevelEditorToolBar.PlayToolBar</code> 添加工具栏按钮</li></ul><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">UToolMenu</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> Menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">ExtendMenu</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LevelEditor.LevelEditorToolBar.PlayToolBar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuSection</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Section </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ToolbarMenu</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">FindOrAddSection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">NAME_None</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuEntry</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Entry </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Section</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddEntry</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FToolMenuEntry</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">InitToolBarButton</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FMyCommands</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">().</span><span style="color:#A6ACCD;">PluginAction</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">Entry</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetCommandList</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">PluginCommands</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="添加菜单按钮" tabindex="-1">添加菜单按钮 <a class="header-anchor" href="#添加菜单按钮" aria-hidden="true">#</a></h3><ul><li>拓展 <code>LevelEditor.LevelEditorToolBar.PlayToolBar</code> 添加工具栏菜单按钮</li></ul><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">UToolMenu</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> Menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">ExtendMenu</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LevelEditor.LevelEditorToolBar.PlayToolBar</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuSection</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Section </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ToolbarMenu</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">FindOrAddSection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">NAME_None</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">Section</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddEntry</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FToolMenuEntry</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">InitComboButton</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">              // Name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">FUIAction</span><span style="color:#89DDFF;">(),</span><span style="color:#676E95;font-style:italic;">           // Action: default</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">FNewToolMenuChoice</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FOnGetContent</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">CreateLambda</span><span style="color:#89DDFF;">([&amp;]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">FMenuBuilder</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MenuBuilder</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">true</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginCommands</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    MenuBuilder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddMenuEntry</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FMyCommands</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">().</span><span style="color:#A6ACCD;">PluginAction</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> MenuBuilder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">MakeWidget</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}))</span></span>
<span class="line"><span style="color:#89DDFF;">));</span></span>
<span class="line"></span></code></pre></div><h2 id="拓展右键菜单" tabindex="-1">拓展右键菜单 <a class="header-anchor" href="#拓展右键菜单" aria-hidden="true">#</a></h2><p>以资源管理器的右键菜单为例，演示如何拓展右键菜单</p><ul><li>拓展内置菜单 <code>ContentBrowser.AssetContextMenu</code></li></ul><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">UToolMenu</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> Menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UToolMenus</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">ExtendMenu</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ContentBrowser.AssetContextMenu</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuSection</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Section </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Menu</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">FindOrAddSection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">NAME_None</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">FToolMenuEntry</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> Entry </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Section</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddEntry</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">FToolMenuEntry</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">InitMenuEntry</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">FMyCommands</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Get</span><span style="color:#89DDFF;">().</span><span style="color:#A6ACCD;">PluginAction</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">Entry</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SetCommandList</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">PluginCommands</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><p>Actor 右键菜单路径为 <code>LevelEditor.ActorContextMenu</code></p><h2 id="拓展其他菜单" tabindex="-1">拓展其他菜单 <a class="header-anchor" href="#拓展其他菜单" aria-hidden="true">#</a></h2><p>不难发现，通过 <code>UToolMenus</code> 进行 Unreal Editor 菜单拓展在用法上具有很高的一致性。前文也提到过，Unreal Editor 中的所有菜单均由 <code>UToolMenus</code> 对象维护，理论上可以使用这种方法拓展编辑器内的任何菜单。</p><p>此外，Unreal Editor 还提供了相应的开发者工具，便于我们快速查找编辑器 UI 中注入点的名称。</p><p>在 Editor Preference 中打开</p><p><code>General -&gt; Miscellaneous -&gt; Developer Tools -&gt; Display UI Extension Points</code></p><p>即可查看所有可被拓展的菜单名称</p>`,45),e=[p];function t(c,r,F,D,y,i){return a(),n("div",null,e)}const C=s(o,[["render",t]]);export{d as __pageData,C as default};
